<!-- TOC -->

- [Spring Bean注入](#spring-bean注入)
    - [传统方式](#传统方式)
    - [注解方式](#注解方式)
- [自定义FilterType](#自定义filtertype)

<!-- /TOC -->

## Spring Bean注入

### 传统方式
1. 配置`beans.xml`，添加实例到容器里
```xml
<bean id="person1" class="com.whoiszxl.bean.Person">
	<property name="name" value="zhangsan"></property>
	<property name="age" value="20"></property>
</bean>
```
2. 通过`ClassPathXmlApplicationContext`读取xml加载配置到容器里
```java
ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext("beans.xml");
Person person = (Person) context.getBean("person1");
System.out.println(person);
```

### 注解方式
1. 编写一个JavaConfig类，先添加`@Configuration`告诉spring这是一个配置类，配置类==配置文件,其它可以使用方法添加`@Bean`注解的方式或者`@ComponentScan`扫描所有的类，其中注解上可以添加filter规则
```java
/**
 * @ComponentScan
 * value: 指定需要扫描的包
 * excludeFilters:指定需要按照什么filter规则排除哪些组件
 * includeFilters:指定需要按照什么filter规则包含哪些组件,配置这个的时候需要关闭默认扫描所有包的规则useDefaultFilters
 * @author whoiszxl
 *
 */
@Configuration //告诉spring这是一个配置类，配置类==配置文件
@ComponentScan(value="com.whoiszxl", excludeFilters = {
		@Filter(type=FilterType.ANNOTATION, classes= {Controller.class})//过滤掉Controller注解的类
})
public class MainConfig {

	/**
	 * 给容器中注册一个Bean
	 * 类型为返回值的类型
	 * id默认是用方法名作为id
	 * 注解后面配置了就取配置的
	 * @return
	 */
	@Bean("zhouer")
	public Person person() {
		return new Person("周二", 22);
	}
}
```
2. 使用`AnnotationConfigApplicationContext`可以加载JavaConfig类
```java
AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(MainConfig.class);
String[] beanNames = context.getBeanDefinitionNames();
for (String name : beanNames) {
	System.out.println(name);
}
System.out.println(context.getBean("userService"));
```

## 自定义FilterType
通过配置自定义FilterType，在自定义代码中可以获取到容器中的关于类的一些信息，通过这些信息可以去写一些自定义的筛选条件
```java
public class MyTypeFilter implements TypeFilter{

	public boolean match(MetadataReader metadataReader, MetadataReaderFactory metadataReaderFactory)
			throws IOException {
		
		//获取当前类注解的信息
		AnnotationMetadata annotationMetadata = metadataReader.getAnnotationMetadata();
		
		//获取当前正在扫描的类信息
		ClassMetadata classMetadata = metadataReader.getClassMetadata();
		
		//获取当前类资源（类路径）
		Resource resource = metadataReader.getResource();
		
		String className = classMetadata.getClassName();
		System.out.println("-->"+className);
		
		String className2 = annotationMetadata.getClassName();
		System.out.println("==>"+className2);
		
		//过滤掉容器中类名中包含User的
		if(className.contains("User")) {
			return false;
		}
		return true;
	}

}
```